(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[653],{63:(e,t,r)=>{"use strict";var a=r(7260);r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}})},796:(e,t,r)=>{Promise.resolve().then(r.bind(r,3426))},3426:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>p});var a=r(5155),l=r(2115),o=r(63),s=r(8712);function i(e){var t,r,l;let{node:o,onClick:s}=e;return(0,a.jsxs)("div",{className:"absolute flex flex-col justify-center items-center p-4 rounded-xl border-2 cursor-pointer transition-all shadow-lg backdrop-blur-sm ".concat((e=>{switch(e){case"crawler":return"border-blue-500 bg-blue-500/10 hover:bg-blue-500/20";case"translator":return"border-purple-500 bg-purple-500/10 hover:bg-purple-500/20";case"forwarder":return"border-orange-500 bg-orange-500/10 hover:bg-orange-500/20";case"formatter":return"border-pink-500 bg-pink-500/10 hover:bg-pink-500/20";case"target":return"border-green-500 bg-green-500/10 hover:bg-green-500/20";default:return"border-gray-500"}})(o.type)),style:{left:o.x,top:o.y,width:o.width,height:o.height},onClick:()=>s(o),children:[(0,a.jsx)("div",{className:"text-2xl mb-2",children:(e=>{switch(e){case"crawler":return"\uD83D\uDD77️";case"translator":return"\uD83C\uDF10";case"forwarder":return"⏩";case"formatter":return"\uD83C\uDFA8";case"target":return"\uD83C\uDFAF";default:return"\uD83D\uDCE6"}})(o.type)}),(0,a.jsx)("div",{className:"text-white font-bold text-center text-sm w-full px-2 break-words whitespace-normal leading-tight",title:o.label,children:o.label}),(0,a.jsx)("div",{className:"text-white/40 text-xs mt-1 uppercase tracking-wider",children:o.type}),(null==(t=o.data)?void 0:t.enabled)===!1&&(0,a.jsx)("div",{className:"absolute top-2 right-2 w-2 h-2 rounded-full bg-red-500",title:"Disabled"}),("crawler"===o.type||"forwarder"===o.type)&&(null==(l=o.data)||null==(r=l.cfg)?void 0:r.cron)&&(0,a.jsx)("div",{className:"absolute bottom-2 right-2 text-[10px] text-white/50 font-mono",children:"⏰"})]})}function n(e){let{node:t,onSave:r,onClose:o,availableCookies:s=[]}=e,[i,n]=(0,l.useState)({}),[h,f]=(0,l.useState)(""),[p,g]=(0,l.useState)(!1);(0,l.useEffect)(()=>{var e,r,a,l,o,s,i,c,d;if("crawler"===t.type){let l=t.data;n({name:l.name,task_type:l.task_type||"article",cron:(null==(e=l.cfg_crawler)?void 0:e.cron)||"",cookie_file:(null==(r=l.cfg_crawler)?void 0:r.cookie_file)||"",engine:(null==(a=l.cfg_crawler)?void 0:a.engine)||"browser",websites:l.websites?l.websites.join("\n"):""})}else if("translator"===t.type){let e=t.data;n({provider:e.provider||"Google",api_key:e.api_key||"",model_id:(null==(l=e.cfg_translator)?void 0:l.model_id)||"",prompt:(null==(o=e.cfg_translator)?void 0:o.prompt)||"",base_url:(null==(s=e.cfg_translator)?void 0:s.base_url)||""})}else if("forwarder"===t.type){let e=t.data;n({name:e.name,task_type:e.task_type||"article",cron:(null==(i=e.cfg_forwarder)?void 0:i.cron)||"",websites:e.websites?e.websites.join("\n"):"",task_title:e.task_title||""})}else if("formatter"===t.type)n({render_type:t.data.render_type||"text"});else if("target"===t.type){let e=t.data,r=e.cfg_platform||{};n({platform:e.platform,id:e.id,replace_regex:JSON.stringify((null==(c=e.cfg_platform)?void 0:c.replace_regex)||"",null,2),block_until:(null==(d=e.cfg_platform)?void 0:d.block_until)||"",tg_token:r.token||"",tg_chat_id:r.chat_id||"",qq_url:r.url||"",qq_group_id:r.group_id||"",qq_token:r.token||"",bili_sessdata:r.sessdata||"",bili_jct:r.bili_jct||"",bili_media_check:r.media_check_level||"loose",json_config:JSON.stringify(e.cfg_platform,null,2)})}},[t]);let b=(e,t)=>{n(r=>({...r,[e]:t}))},x=async e=>{if(e){g(!0);try{let t=await fetch("/api/cookies/view/".concat(encodeURIComponent(e.replace(".txt",""))));if(!t.ok)throw Error("Failed to fetch cookie file");let r=(await t.json()).content.split("\n"),a="",l="";for(let e of r){if(e.startsWith("#")||!e.trim())continue;let t=e.split("	");if(t.length>=7){let e=t[5],r=t[6];"SESSDATA"===e&&(a=r.trim()),"bili_jct"===e&&(l=r.trim())}}a&&l?(n(e=>({...e,bili_sessdata:a,bili_jct:l})),alert("Successfully imported credentials from ".concat(e))):alert("Could not find SESSDATA or bili_jct in the selected cookie file.")}catch(e){alert("Import failed: ".concat(e.message))}finally{g(!1)}}};return(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-8",children:(0,a.jsxs)("div",{className:"bg-gray-900 border border-white/20 rounded-2xl w-full max-w-2xl max-h-full overflow-y-auto shadow-2xl flex flex-col",children:[(0,a.jsxs)("div",{className:"p-6 border-b border-white/10 flex justify-between items-center",children:[(0,a.jsxs)("h2",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[(0,a.jsx)("span",{children:"✏️"})," Edit ",t.label]}),(0,a.jsx)("button",{onClick:o,className:"text-white/60 hover:text-white",children:"✕"})]}),(0,a.jsxs)("div",{className:"p-6 space-y-6 flex-grow overflow-auto",children:["crawler"===t.type&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c,{label:"Name",value:i.name,onChange:e=>b("name",e)}),(0,a.jsx)(u,{label:"Task Type",value:i.task_type,options:["article","follows"],onChange:e=>b("task_type",e)}),(0,a.jsx)(c,{label:"Schedule (Cron)",value:i.cron,onChange:e=>b("cron",e),placeholder:"* * * * *"}),(0,a.jsx)(u,{label:"Cookie File Path",value:i.cookie_file,options:["",...s],onChange:e=>b("cookie_file",e)}),(0,a.jsx)(d,{label:"Websites (One per line)",value:i.websites,onChange:e=>b("websites",e)})]}),"translator"===t.type&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"mb-4 bg-blue-500/10 p-3 rounded border border-blue-500/30 text-xs text-blue-200",children:'Tip: Treat this as an "LLM Profile" that can be reused.'}),(0,a.jsx)(u,{label:"Provider",value:i.provider,options:["Google","BigModel","Deepseek","Openai","ByteDance","None"],onChange:e=>b("provider",e)}),(0,a.jsx)(c,{label:"API Key",value:i.api_key,onChange:e=>b("api_key",e),type:"password"}),(0,a.jsx)(c,{label:"Base URL (Optional)",value:i.base_url,onChange:e=>b("base_url",e),placeholder:"https://api.openai.com/v1"}),(0,a.jsx)(c,{label:"Model ID",value:i.model_id,onChange:e=>b("model_id",e)}),(0,a.jsx)(d,{label:"System Prompt",value:i.prompt,onChange:e=>b("prompt",e)})]}),"forwarder"===t.type&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c,{label:"Name",value:i.name,onChange:e=>b("name",e)}),(0,a.jsx)(u,{label:"Task Type",value:i.task_type,options:["article","follows"],onChange:e=>b("task_type",e)}),(0,a.jsx)(c,{label:"Task Title",value:i.task_title,onChange:e=>b("task_title",e)}),(0,a.jsx)(c,{label:"Schedule (Cron)",value:i.cron,onChange:e=>b("cron",e),placeholder:"* * * * *"}),(0,a.jsx)(d,{label:"Target Websites (Filter)",value:i.websites,onChange:e=>b("websites",e)})]}),"formatter"===t.type&&(0,a.jsx)(u,{label:"Format / Layout",value:i.render_type,options:[{label:"Text Only",value:"text"},{label:"Standard Image Card",value:"img"},{label:"Image with Metadata",value:"img-with-meta"}],onChange:e=>b("render_type",e)}),"target"===t.type&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u,{label:"Platform",value:i.platform,options:["telegram","bilibili","qq","none"],onChange:e=>b("platform",e)}),(0,a.jsx)(c,{label:"Target ID (Optional)",value:i.id,onChange:e=>b("id",e)}),"telegram"===i.platform&&(0,a.jsxs)("div",{className:"p-4 bg-white/5 rounded-lg border border-white/10 space-y-4",children:[(0,a.jsx)("h3",{className:"font-bold text-sm text-blue-300",children:"Telegram Settings"}),(0,a.jsx)(c,{label:"Bot Token",value:i.tg_token,onChange:e=>b("tg_token",e)}),(0,a.jsx)(c,{label:"Chat ID",value:i.tg_chat_id,onChange:e=>b("tg_chat_id",e)})]}),"qq"===i.platform&&(0,a.jsxs)("div",{className:"p-4 bg-white/5 rounded-lg border border-white/10 space-y-4",children:[(0,a.jsx)("h3",{className:"font-bold text-sm text-blue-300",children:"QQ Bot Settings"}),(0,a.jsx)(c,{label:"API URL",value:i.qq_url,onChange:e=>b("qq_url",e),placeholder:"http://127.0.0.1:3000"}),(0,a.jsx)(c,{label:"Access Token",value:i.qq_token,onChange:e=>b("qq_token",e)}),(0,a.jsx)(c,{label:"Group ID",value:i.qq_group_id,onChange:e=>b("qq_group_id",e)})]}),"bilibili"===i.platform&&(0,a.jsxs)("div",{className:"p-4 bg-white/5 rounded-lg border border-white/10 space-y-4",children:[(0,a.jsx)("h3",{className:"font-bold text-sm text-pink-300",children:"Bilibili Settings"}),(0,a.jsxs)("div",{className:"flex gap-2 items-end",children:[(0,a.jsx)(u,{label:"Import Credentials from Cookie",value:"",options:["Select a cookie file...",...s],onChange:e=>x(e)}),p&&(0,a.jsx)("span",{className:"mb-2 text-sm text-white/50",children:"Loading..."})]}),(0,a.jsx)(c,{label:"SESSDATA",value:i.bili_sessdata,onChange:e=>b("bili_sessdata",e),type:"password"}),(0,a.jsx)(c,{label:"Bili JCT",value:i.bili_jct,onChange:e=>b("bili_jct",e),type:"password"}),(0,a.jsx)(u,{label:"Media Check Level",value:i.bili_media_check,options:["strict","loose","none"],onChange:e=>b("bili_media_check",e)})]}),(0,a.jsxs)("div",{className:"mt-4 pt-4 border-t border-white/10",children:[(0,a.jsx)("h3",{className:"font-bold text-sm text-white/60 mb-2",children:"Common Settings"}),(0,a.jsx)(d,{label:"Replace Regex (JSON or String)",value:i.replace_regex,onChange:e=>b("replace_regex",e),fontMono:!0}),(0,a.jsx)(c,{label:"Block Until (Time Duration)",value:i.block_until,onChange:e=>b("block_until",e),placeholder:"e.g. 1h, 30m"})]})]})]}),(0,a.jsxs)("div",{className:"p-6 border-t border-white/10 bg-black/20 flex justify-end gap-3",children:[(0,a.jsx)("button",{onClick:o,className:"px-4 py-2 rounded-lg text-white/70 hover:bg-white/10 transition-colors",children:"Cancel"}),(0,a.jsx)("button",{onClick:()=>{let e={...t.data};if("crawler"===t.type)e.name=i.name,e.task_type=i.task_type,e.websites=i.websites.split("\n").filter(e=>e.trim()),e.cfg_crawler||(e.cfg_crawler={}),e.cfg_crawler.cron=i.cron,e.cfg_crawler.cookie_file=i.cookie_file,e.cfg_crawler.engine=i.engine;else if("translator"===t.type)e.provider=i.provider,e.api_key=i.api_key,e.cfg_translator||(e.cfg_translator={}),e.cfg_translator.model_id=i.model_id,e.cfg_translator.prompt=i.prompt,e.cfg_translator.base_url=i.base_url;else if("forwarder"===t.type)e.name=i.name,e.task_type=i.task_type,e.task_title=i.task_title,e.websites=i.websites.split("\n").filter(e=>e.trim()),e.cfg_forwarder||(e.cfg_forwarder={}),e.cfg_forwarder.cron=i.cron;else if("formatter"===t.type)e.render_type=i.render_type;else if("target"===t.type){e.platform=i.platform,e.id=i.id;let t={};if("telegram"===i.platform)t.token=i.tg_token,t.chat_id=i.tg_chat_id;else if("qq"===i.platform)t.url=i.qq_url,t.group_id=i.qq_group_id,t.token=i.qq_token;else if("bilibili"===i.platform)t.sessdata=i.bili_sessdata,t.bili_jct=i.bili_jct,t.media_check_level=i.bili_media_check;else try{let e=JSON.parse(i.json_config||"{}");Object.assign(t,e)}catch(e){}if(i.replace_regex)try{i.replace_regex.trim().startsWith("[")||i.replace_regex.trim().startsWith('"')?t.replace_regex=JSON.parse(i.replace_regex):t.replace_regex=i.replace_regex}catch(e){t.replace_regex=i.replace_regex}i.block_until&&(t.block_until=i.block_until),e.cfg_platform=t}r(t,e)},className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors font-medium",children:"Save Changes"})]})]})})}function c(e){let{label:t,value:r,onChange:l,type:o="text",placeholder:s}=e;return(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-white/80 mb-1",children:t}),(0,a.jsx)("input",{type:o,value:r||"",onChange:e=>l(e.target.value),placeholder:s,className:"w-full px-4 py-2 bg-black/30 border border-white/10 rounded-lg text-white placeholder-white/30 focus:outline-none focus:ring-2 focus:ring-blue-500"})]})}function d(e){let{label:t,value:r,onChange:l,fontMono:o}=e;return(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-white/80 mb-1",children:t}),(0,a.jsx)("textarea",{rows:4,value:r||"",onChange:e=>l(e.target.value),className:"w-full px-4 py-2 bg-black/30 border border-white/10 rounded-lg text-white placeholder-white/30 focus:outline-none focus:ring-2 focus:ring-blue-500 ".concat(o?"font-mono text-xs":"")})]})}function u(e){let{label:t,value:r,options:l,onChange:o}=e;return(0,a.jsxs)("div",{className:"flex-grow",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-white/80 mb-1",children:t}),(0,a.jsx)("select",{value:r||"",onChange:e=>o(e.target.value),className:"w-full px-4 py-2 bg-black/30 border border-white/10 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500 appearance-none",children:l.map(e=>{let t="object"==typeof e?e.label:e,r="object"==typeof e?e.value:e;return(0,a.jsx)("option",{value:r,children:t},r)})})]})}var h=r(6671),f=r.n(h);function p(){let{user:e,loading:t}=(0,s.A)(),r=(0,o.useRouter)(),[c,d]=(0,l.useState)(null),[u,h]=(0,l.useState)([]),[p,g]=(0,l.useState)([]),[b,x]=(0,l.useState)(!1),[m,w]=(0,l.useState)(""),[_,v]=(0,l.useState)(null),[y,j]=(0,l.useState)(!1),[k,N]=(0,l.useState)(null),[C,S]=(0,l.useState)(!1);(0,l.useEffect)(()=>{t||e||r.push("/auth/login?redirect=/config")},[e,t,r]),(0,l.useEffect)(()=>{e&&E()},[e]);let[T,q]=(0,l.useState)([]),E=async()=>{x(!0),w("");try{let[e,t]=await Promise.all([fetch("/api/config"),fetch("/api/cookies/list")]);if(401===e.status||401===t.status)return void r.push("/auth/login?redirect=/config");if(!e.ok)throw Error("Failed to fetch config");let a=await e.json();if(d(a),R(a),t.ok){let e=await t.json();q(e.map(e=>e.filename))}}catch(e){w(e instanceof Error?e.message:"Failed to load data")}finally{x(!1)}},R=e=>{let t=[],r=[],a=e.crawlers||[],l=e.forwarders||[],o=e.forward_targets||[];a.forEach((e,a)=>{var o,s;let i="crawler-".concat(a);if(t.push({id:i,type:"crawler",label:e.name||"Crawler ".concat(a+1),data:e,x:50,y:120*a+100,width:250,height:100}),null==(o=e.cfg_crawler)?void 0:o.translator){let l="translator-".concat(a);t.push({id:l,type:"translator",label:"Translate (".concat(e.cfg_crawler.translator.provider,")"),data:e.cfg_crawler.translator,x:400,y:120*a+100,width:250,height:100,parentId:i}),r.push({id:"conn-c-t-".concat(a),source:i,target:l})}if(l[a]){let t="forwarder-".concat(a),l=(null==(s=e.cfg_crawler)?void 0:s.translator)?"translator-".concat(a):i;r.push({id:"conn-flow-".concat(a),source:l,target:t})}}),l.forEach((a,l)=>{var o;let s="forwarder-".concat(l),i=120*l+100;t.push({id:s,type:"forwarder",label:a.name||"Forwarder ".concat(l+1),data:a,x:750,y:i,width:250,height:100});let n=(null==(o=a.cfg_forwarder)?void 0:o.render_type)||"text",c="formatter-".concat(l);if(t.push({id:c,type:"formatter",label:"Format: ".concat(n),data:a.cfg_forwarder||{},x:1100,y:i,width:250,height:100,parentId:s}),r.push({id:"conn-f-fmt-".concat(l),source:s,target:c}),e.forward_targets&&e.forward_targets[l]){let e="target-".concat(l);r.push({id:"conn-fmt-t-".concat(l),source:c,target:e})}}),o.forEach((e,r)=>{t.push({id:"target-".concat(r),type:"target",label:"".concat(e.platform," (").concat(e.id||"Global",")"),data:e,x:1450,y:120*r+100,width:250,height:100})}),h(t),g(r)},O=async(e,t)=>{if(!c)return;let r=f().cloneDeep(c),[a,l]=e.id.split("-"),o=parseInt(l);"crawler"===a?r.crawlers&&r.crawlers[o]&&(r.crawlers[o]=t):"translator"===a?r.crawlers&&r.crawlers[o]&&(r.crawlers[o].cfg_crawler||(r.crawlers[o].cfg_crawler={}),r.crawlers[o].cfg_crawler.translator=t):"forwarder"===a?r.forwarders&&r.forwarders[o]&&(r.forwarders[o]=t):"formatter"===a?r.forwarders&&r.forwarders[o]&&(r.forwarders[o].cfg_forwarder||(r.forwarders[o].cfg_forwarder={}),r.forwarders[o].cfg_forwarder.render_type=t.render_type):"target"===a&&r.forward_targets&&r.forward_targets[o]&&(r.forward_targets[o]=t),d(r),R(r),N(null);try{if(v("Saving..."),!(await fetch("/api/config/update",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})).ok)throw Error("Failed to save to backend");v("Saved successfully! Restart server to apply.")}catch(e){v("Error saving: ".concat(e.message))}},A=async()=>{if(confirm("Are you sure you want to restart the backend server? This will interrupt active tasks.")){S(!0),v("Restarting server...");try{if(!(await fetch("/api/server/restart",{method:"POST"})).ok)throw Error("Restart request failed");v("Server restart command sent. Please wait for service to recover."),setTimeout(()=>{S(!1),v("Server should be back up. Refresh if needed.")},5e3)}catch(e){v("Restart Error: ".concat(e.message)),S(!1)}}};return t||!e?(0,a.jsx)("div",{className:"min-h-screen bg-black flex items-center justify-center text-white",children:"Loading..."}):(0,a.jsxs)("div",{className:"min-h-screen bg-[#111] text-white overflow-hidden flex flex-col",children:[(0,a.jsxs)("div",{className:"bg-[#1a1a1a] border-b border-white/10 p-4 flex justify-between items-center z-10 shadow-md",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("h1",{className:"text-xl font-bold flex items-center gap-2",children:[(0,a.jsx)("span",{children:"⚙️"})," Configuration Graph"]}),_&&(0,a.jsx)("span",{className:"text-xs px-2 py-1 rounded ".concat(_.includes("Error")?"bg-red-500/20 text-red-300":"bg-green-500/20 text-green-300"),children:_})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)("button",{onClick:()=>j(!y),className:"px-3 py-1 rounded text-sm transition-colors ".concat(y?"bg-purple-600 text-white":"bg-white/5 hover:bg-white/10"),children:"Debug Info"}),(0,a.jsx)("button",{onClick:E,className:"px-3 py-1 bg-white/5 hover:bg-white/10 rounded text-sm transition-colors",disabled:b,children:"Refresh"}),(0,a.jsx)("button",{onClick:A,disabled:C,className:"px-3 py-1 bg-red-600 hover:bg-red-700 text-white rounded text-sm transition-colors flex items-center gap-2 ".concat(C?"opacity-50 cursor-not-allowed":""),children:C?"Restarting...":"Restart Server"})]})]}),(0,a.jsx)("div",{className:"flex-grow relative overflow-auto bg-[url('/grid.svg')] bg-fixed",style:{backgroundSize:"20px 20px"},children:(0,a.jsxs)("div",{className:"absolute inset-0 min-w-[1500px] min-h-[1000px]",children:[(0,a.jsx)("svg",{className:"absolute inset-0 w-full h-full pointer-events-none z-0",children:p.map(e=>{let t=u.find(t=>t.id===e.source),r=u.find(t=>t.id===e.target);if(!t||!r)return null;let l=t.x+t.width,o=t.y+t.height/2,s=r.x,i=r.y+r.height/2;return(0,a.jsx)("path",{d:"M ".concat(l," ").concat(o," C ").concat(l+50," ").concat(o,", ").concat(s-50," ").concat(i,", ").concat(s," ").concat(i),fill:"none",stroke:"#555",strokeWidth:"2",strokeDasharray:"5,5"},e.id)})}),0===u.length&&!b&&(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:(0,a.jsxs)("div",{className:"text-center p-8 bg-black/50 backdrop-blur-md rounded-xl border border-white/10 select-none pointer-events-auto",children:[(0,a.jsx)("div",{className:"text-4xl mb-4",children:"\uD83D\uDD78️"}),(0,a.jsx)("h3",{className:"text-xl font-bold text-white mb-2",children:"No Configuration Found"}),(0,a.jsxs)("p",{className:"text-white/60 max-w-md",children:["The crawler/forwarder graph is empty. Please check your backend ",(0,a.jsx)("code",{children:"config.yaml"})," or check console for errors."]})]})}),u.map(e=>(0,a.jsx)(i,{node:e,onClick:e=>N(e)},e.id)),(0,a.jsx)("div",{className:"absolute top-4 left-[50px] text-white/20 font-bold text-xl",children:"CRAWLERS"}),(0,a.jsx)("div",{className:"absolute top-4 left-[400px] text-white/20 font-bold text-xl",children:"TRANSLATORS"}),(0,a.jsx)("div",{className:"absolute top-4 left-[750px] text-white/20 font-bold text-xl",children:"FORWARDERS"}),(0,a.jsx)("div",{className:"absolute top-4 left-[1100px] text-white/20 font-bold text-xl",children:"FORMATTERS"}),(0,a.jsx)("div",{className:"absolute top-4 left-[1450px] text-white/20 font-bold text-xl",children:"TARGETS"})]})}),y&&c&&(0,a.jsxs)("div",{className:"h-64 border-t border-white/10 bg-black/90 p-4 font-mono text-xs overflow-auto",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,a.jsx)("h3",{className:"font-bold text-lg text-purple-300",children:"Backend Config Debug"}),(0,a.jsx)("button",{onClick:()=>j(!1),className:"text-white/60 hover:text-white",children:"✕ Close"})]}),(0,a.jsx)("pre",{className:"text-green-400 whitespace-pre-wrap",children:JSON.stringify(c,null,2)})]}),k&&c&&(0,a.jsx)(n,{node:k,fullConfig:c,availableCookies:T,onSave:O,onClose:()=>N(null)})]})}},8712:(e,t,r)=>{"use strict";r.d(t,{WithAuth:()=>n,A:()=>i});var a=r(5155),l=r(2115);let o=(0,l.createContext)(void 0);function s(e){let{children:t}=e,[r,s]=(0,l.useState)(null),[i,n]=(0,l.useState)(!0),c=async()=>{try{let e=await fetch("/api/auth/me",{credentials:"include"});if(e.ok){let t=await e.json();s(t)}else s(null)}catch(e){console.error("Failed to fetch user:",e),s(null)}finally{n(!1)}},d=async(e,t)=>{try{let r=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({username:e,password:t})});if(r.ok){let e=await r.json();return s(e),!0}return!1}catch(e){return console.error("Login failed:",e),!1}},u=async()=>{try{await fetch("/api/auth/logout",{method:"POST",credentials:"include"})}catch(e){console.error("Logout failed:",e)}s(null)},h=async()=>{await c()};return(0,l.useEffect)(()=>{c()},[]),(0,a.jsx)(o.Provider,{value:{user:r,loading:i,login:d,logout:u,refreshUser:h},children:t})}function i(){let e=(0,l.useContext)(o);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}function n(e){let{children:t}=e;return(0,a.jsx)(s,{children:t})}}},e=>{e.O(0,[935,441,255,358],()=>e(e.s=796)),_N_E=e.O()}]);